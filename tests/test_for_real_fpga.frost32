.org 0x0000
main:
{
	; Assume top of available memory is here.
	cpyi sp, 0x7fff

	; Set the interrupt handler
	cpyi u0, interrupt_handler
	cpy idsta, u0

	cpya u0, -7
	cpya u1, -5
	;cpya u0, 5
	;cpya u1, 7

loop:
	inc u0
	;blts u0, u1, loop
	bles u0, u1, loop


	ei

	bra wait_for_interrupt
	;bra quit
}



interrupt_handler:
{
	; The high 8 bits of u7 are shown on the LEDs of my FPGA 
	addi u7, 20
	reti
}


wait_for_interrupt:
{
	dec u7
	bra wait_for_interrupt
}

.org 0x4000
quit:
{
	bra quit
}

.org 0x6000
data:
	.space 4


;.org 0x9000
;; Write to this address to trigger the interrupt
;trigger_an_interrupt:
